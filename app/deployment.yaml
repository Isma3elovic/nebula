apiVersion: apps/v1
kind: Deployment
# ... metadata ...
spec:
  # ... selector, replicas ...
  template:
    # ... metadata ...
    spec:
      containers:
      - name: wiki-service
        image: "{{ .Values.fastapiImage.repository }}:{{ .Values.fastapiImage.tag }}"
        ports:
        - containerPort: 8000
        env: # Crucial: pass DB connection details to FastAPI
        - name: POSTGRES_HOST
          value: "postgresql-service" # Name of the PostgreSQL Service (e.g., in this chart)
        - name: POSTGRES_USER
          value: {{ .Values.postgresql.user | quote }}
        - name: POSTGRES_PASSWORD
          valueFrom: # Use a Secret for production readiness (better than literal values)
            secretKeyRef:
              name: postgres-secret
              key: postgres-password
        # ... other environment variables ...
